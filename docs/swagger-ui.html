<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üõí Ghanshyam Murti Bhandar - Complete API Documentation</title>
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui.css" />
    <style>
        html {
            box-sizing: border-box;
            overflow: -moz-scrollbars-vertical;
            overflow-y: scroll;
        }
        *, *:before, *:after {
            box-sizing: inherit;
        }
        body {
            margin:0;
            background: #fafafa;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        .swagger-ui .topbar {
            background-color: #2c3e50;
            padding: 10px 0;
        }
        .swagger-ui .topbar .download-url-wrapper {
            display: none;
        }
        .custom-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }
        .custom-header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        .custom-header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }
        .credentials-box {
            background: #e8f5e8;
            border: 2px solid #4caf50;
            border-radius: 8px;
            padding: 15px;
            margin: 20px;
            font-family: monospace;
        }
        .credentials-box h3 {
            margin-top: 0;
            color: #2e7d32;
        }
        .credentials-box code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 4px;
            color: #d32f2f;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px;
        }
        .feature-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
        }
        .feature-card h4 {
            margin-top: 0;
            color: #2c3e50;
        }
        .feature-card ul {
            margin: 0;
            padding-left: 20px;
        }
        .feature-card li {
            margin: 5px 0;
            color: #555;
        }
        .stats-bar {
            background: #2c3e50;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }
        .stat-item {
            text-align: center;
            margin: 5px;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #4caf50;
        }
        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="custom-header">
        <h1>üõí Ghanshyam Murti Bhandar</h1>
        <p>Complete Ecommerce Platform API Documentation</p>
        <p><strong>150+ Endpoints | Enterprise-Grade | Android Integration Ready</strong></p>
    </div>

    <div class="stats-bar">
        <div class="stat-item">
            <div class="stat-number">150+</div>
            <div class="stat-label">API Endpoints</div>
        </div>
        <div class="stat-item">
            <div class="stat-number">95%</div>
            <div class="stat-label">Complete</div>
        </div>
        <div class="stat-item">
            <div class="stat-number">15</div>
            <div class="stat-label">Categories</div>
        </div>
        <div class="stat-item">
            <div class="stat-number">100%</div>
            <div class="stat-label">Mobile Ready</div>
        </div>
    </div>

    <div class="credentials-box">
        <h3>üîë Android Integration Credentials</h3>
        <p><strong>Backend URL:</strong> <code id="backend-url">Loading...</code></p>
        <p><strong>Razorpay Key ID:</strong> <code>rzp_test_4hUj1dxGbUR5wj</code></p>
        <p><strong>Admin Email:</strong> <code>admin@ghanshyambhandar.com</code></p>
        <p><strong>Admin Password:</strong> <code>admin123</code></p>
        <p><strong>JWT Authentication:</strong> Include <code>Authorization: Bearer &lt;token&gt;</code> header</p>
    </div>

    <div class="feature-grid">
        <div class="feature-card">
            <h4>üîê Authentication</h4>
            <ul>
                <li>User Registration & Login</li>
                <li>JWT Token Authentication</li>
                <li>Profile Management</li>
                <li>Role-based Access Control</li>
            </ul>
        </div>
        <div class="feature-card">
            <h4>üì¶ Products</h4>
            <ul>
                <li>Product Catalog with Filters</li>
                <li>Category Management</li>
                <li>Search & Sorting</li>
                <li>Image Management</li>
            </ul>
        </div>
        <div class="feature-card">
            <h4>üõí Shopping</h4>
            <ul>
                <li>Shopping Cart Management</li>
                <li>Wishlist Functionality</li>
                <li>Real-time Pricing</li>
                <li>Cart Persistence</li>
            </ul>
        </div>
        <div class="feature-card">
            <h4>üí≥ Payments</h4>
            <ul>
                <li>Razorpay Integration</li>
                <li>Cash on Delivery</li>
                <li>Wallet Payments</li>
                <li>Payment Verification</li>
            </ul>
        </div>
        <div class="feature-card">
            <h4>üìã Orders</h4>
            <ul>
                <li>Order Management</li>
                <li>Status Tracking</li>
                <li>Order History</li>
                <li>Invoice Generation</li>
            </ul>
        </div>
        <div class="feature-card">
            <h4>üöö Shipping</h4>
            <ul>
                <li>Shiprocket Integration</li>
                <li>Real-time Tracking</li>
                <li>Multiple Couriers</li>
                <li>Delivery Management</li>
            </ul>
        </div>
    </div>

    <div id="swagger-ui"></div>

    <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-bundle.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-standalone-preset.js"></script>
    <script>
        window.onload = function() {
            // Dynamically determine the backend URL
            const protocol = window.location.protocol;
            const hostname = window.location.hostname;
            const port = window.location.port;

            // Construct base URL
            let baseUrl;
            if (hostname === 'localhost' || hostname === '127.0.0.1') {
                // Development environment
                baseUrl = `${protocol}//${hostname}:${port || '8080'}`;
            } else {
                // Production environment
                baseUrl = `${protocol}//${hostname}${port ? ':' + port : ''}`;
            }

            const apiUrl = baseUrl + '/api';

            // Update the credentials display
            document.getElementById('backend-url').textContent = apiUrl;

            // Create dynamic Swagger configuration
            const swaggerConfig = {
                url: '/api/swagger.yaml',
                dom_id: '#swagger-ui',
                deepLinking: true,
                presets: [
                    SwaggerUIBundle.presets.apis,
                    SwaggerUIStandalonePreset
                ],
                plugins: [
                    SwaggerUIBundle.plugins.DownloadUrl
                ],
                layout: "StandaloneLayout",
                tryItOutEnabled: true,
                requestInterceptor: function(request) {
                    // Ensure proper base URL for API requests
                    if (!request.url.startsWith('http')) {
                        request.url = baseUrl + request.url;
                    }
                    return request;
                },
                responseInterceptor: function(response) {
                    return response;
                },
                onComplete: function() {
                    console.log("Swagger UI loaded successfully!");
                    console.log("API Base URL:", apiUrl);
                    console.log("Environment:", hostname === 'localhost' || hostname === '127.0.0.1' ? 'Development' : 'Production');

                    // Set the correct server in Swagger UI
                    if (window.ui && window.ui.getSystem) {
                        const system = window.ui.getSystem();
                        if (system.specActions) {
                            // Update the servers list to show current environment first
                            const currentServer = hostname === 'localhost' || hostname === '127.0.0.1'
                                ? 'http://localhost:8080/api'
                                : 'https://server.ghanshyammurtibhandar.com/api';

                            console.log("Current server set to:", currentServer);
                        }
                    }
                },
                onFailure: function(error) {
                    console.error("Failed to load Swagger UI:", error);
                    console.log("Current hostname:", hostname);
                    console.log("Base URL:", baseUrl);

                    // Show user-friendly error message
                    const swaggerContainer = document.getElementById('swagger-ui');
                    if (swaggerContainer) {
                        swaggerContainer.innerHTML = `
                            <div style="padding: 20px; text-align: center; color: #721c24; background-color: #f8d7da; border: 1px solid #f5c6cb; border-radius: 4px; margin: 20px;">
                                <h3>‚ö†Ô∏è Swagger UI Loading Error</h3>
                                <p><strong>Current Environment:</strong> ${hostname === 'localhost' ? 'Development' : 'Production'}</p>
                                <p><strong>API Base URL:</strong> ${apiUrl}</p>
                                <p><strong>Error:</strong> ${error.message || 'Failed to load API documentation'}</p>
                                <hr>
                                <p><strong>For Development:</strong> Make sure your backend is running on <code>http://localhost:8080</code></p>
                                <p><strong>For Production:</strong> Make sure your backend is deployed and accessible at <code>https://server.ghanshyammurtibhandar.com</code></p>
                                <button onclick="window.location.reload()" style="background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin-top: 10px;">
                                    üîÑ Retry Loading
                                </button>
                            </div>
                        `;
                    }
                }
            };

            // Begin Swagger UI call region
            const ui = SwaggerUIBundle(swaggerConfig);
            // End Swagger UI call region

            window.ui = ui;
        };
    </script>
</body>
</html>
